/**
 * Exploitation Agents - Index
 * 
 * Agents that validate vulnerability hypotheses through
 * active exploitation and proof-of-concept generation.
 */

import { NucleiScanAgent } from './nuclei-agent.js';
import { MetasploitAgent } from './metasploit-agent.js';
import { SQLmapAgent } from './sqlmap-agent.js';
import { XSSValidatorAgent } from './xss-validator-agent.js';
import { CommandInjectionAgent } from './cmdi-agent.js';

export { NucleiScanAgent, MetasploitAgent, SQLmapAgent, XSSValidatorAgent, CommandInjectionAgent };

/**
 * Register all exploitation agents with orchestrator
 * @param {Orchestrator} orchestrator - Orchestrator instance
 */
export function registerExploitationAgents(orchestrator) {
    orchestrator.registerAgent(new NucleiScanAgent());

    // Register separate instances for Recon and Exploitation phases
    orchestrator.registerAgent(new MetasploitAgent({
        name: 'MetasploitRecon',
        defaultMode: 'recon'
    }));

    orchestrator.registerAgent(new MetasploitAgent({
        name: 'MetasploitExploit',
        defaultMode: 'exploitation'
    }));

    orchestrator.registerAgent(new SQLmapAgent());
    orchestrator.registerAgent(new XSSValidatorAgent());
    orchestrator.registerAgent(new CommandInjectionAgent());
}
